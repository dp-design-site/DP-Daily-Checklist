<!DOCTYPE html>
<html lang="bg">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>DP Daily Notes</title>
  <link rel="icon" type="image/png" href="img/DP_fav.png">
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#121212">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-title" content="DP Daily">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <link rel="apple-touch-icon" href="img/DP_fav.png">
  <style>
    :root { --bg:#121212; --fg:#e0e0e0; --card:#1e1e1e; --muted:#9e9e9e; --accent:#90caf9; --border:#333; }
    * { box-sizing: border-box; }
    body { font-family: Arial, sans-serif; background-color: var(--bg); color: var(--fg); margin: 0; padding: 20px; }
    h1 { text-align: center; color: var(--accent); margin: 0 0 8px; }
    .week-counter { text-align: center; font-size: 16px; margin-bottom: 10px; color: #b0bec5; }
    .toolbar { display:flex; gap:8px; justify-content:center; flex-wrap:wrap; margin: 12px 0; }
    .progress { width: 100%; background: var(--border); border-radius: 10px; margin: 12px 0 16px; overflow:hidden; }
    .progress-bar { height: 20px; background: var(--accent); width: 0%; border-radius: 10px; text-align: center; font-size: 12px; color: #000; }
    table { width: 100%; border-collapse: collapse; margin-top: 12px; }
    th, td { border: 1px solid var(--border); padding: 10px; text-align: left; }
    th { background: var(--card); }
    button { background: var(--accent); border: none; padding: 8px 12px; border-radius: 8px; cursor: pointer; color:#062234; font-weight:600; }
    button.secondary { background:#2a2a2a; color: var(--fg); border:1px solid var(--border); }
    button:hover { filter: brightness(1.05); }
    .footer { text-align: center; margin-top: 20px; font-size: 14px; color: var(--muted); }
    /* Modal */
    .modal-backdrop { position: fixed; inset: 0; background: rgba(0,0,0,0.6); display:none; align-items: center; justify-content: center; padding:16px; }
    .modal { width: 100%; max-width: 560px; background: var(--card); border:1px solid var(--border); border-radius: 12px; padding:16px; }
    .modal h3 { margin:0 0 8px; }
    .row { display:flex; gap:8px; flex-wrap:wrap; align-items:center; }
    .days { display:grid; grid-template-columns: repeat(4, minmax(0,1fr)); gap:6px; margin: 8px 0 12px; }
    .days label { background:#2a2a2a; border:1px solid var(--border); border-radius:8px; padding:6px 8px; display:flex; align-items:center; gap:6px; }
    .checklist { list-style:none; margin:8px 0 0; padding:0; max-height: 40vh; overflow:auto; }
    .checklist li { display:flex; gap:8px; align-items:center; border-bottom:1px dashed var(--border); padding:6px 4px; }
    .hidden { display:none; }
  </style>
</head>
<body>
  <h1>DP Daily Notes</h1>
  <div class="week-counter" id="weekCounter"></div>
  <div class="progress"><div class="progress-bar" id="progressBar">0%</div></div>

    <div class="toolbar">
    <button id="toggleWeekBtn" class="secondary">üóì –°–µ–¥–º–∏—Ü–∞</button>
    <button id="travelBtn">üì¶ –ü—ä—Ç—É–≤–∞–º</button>
    <button id="planBtn" class="secondary">üìò –ü–ª–∞–Ω / –û–±—è—Å–Ω–µ–Ω–∏—è</button>
    <button id="resetBtn" class="secondary">‚ôªÔ∏è –†–µ—Å–µ—Ç –ø—Ä–æ–≥—Ä–µ—Å</button>
    <button class="secondary" onclick="showHistory()">üìä –ò—Å—Ç–æ—Ä–∏—è</button>
  </div>

  <section id="weekSection" class="hidden">
    <h2>–°–µ–¥–º–∏—á–µ–Ω –ø–ª–∞–Ω</h2>
    <table id="weekPlan">
      <thead>
        <tr><th>–î–µ–Ω</th><th>–ß–∞—Å</th><th>–ó–∞–¥–∞—á–∞</th></tr>
      </thead>
      <tbody id="weekPlanBody"></tbody>
    </table>
  </section>

  <h2 id="dayTitle"></h2>
  <table id="dayPlan">
    <thead>
      <tr><th>–ß–∞—Å</th><th>–ó–∞–¥–∞—á–∞</th><th>–°—Ç–∞—Ç—É—Å</th></tr>
    </thead>
    <tbody id="planBody"></tbody>
  </table>

  <!-- Travel Modal -->
  <div id="travelBackdrop" class="modal-backdrop">
    <div class="modal">
      <div class="row" style="justify-content:space-between">
        <h3>üì¶ –°–ø–∏—Å—ä–∫ –∑–∞ –ø—ä—Ç—É–≤–∞–Ω–µ</h3>
        <button class="secondary" onclick="closeTravel()">‚úñ</button>
      </div>
      <p class="muted">–ò–∑–±–µ—Ä–∏ –≤ –∫–æ–∏ –¥–Ω–∏ —â–µ –ø—ä—Ç—É–≤–∞—à –∏ –≥–µ–Ω–µ—Ä–∏—Ä–∞–π —á–µ–∫–ª–∏—Å—Ç —Å –Ω–µ–æ–±—Ö–æ–¥–∏–º–∏—Ç–µ –Ω–µ—â–∞.</p>
      <div class="days" id="travelDays"></div>
      <div class="row">
        <button onclick="generatePacking()">–ì–µ–Ω–µ—Ä–∏—Ä–∞–π —Å–ø–∏—Å—ä–∫</button>
        <button class="secondary" onclick="copyPacking()">–ö–æ–ø–∏—Ä–∞–π</button>
        <button class="secondary" onclick="window.print()">–ü–µ—á–∞—Ç</button>
      </div>
      <ul id="packingList" class="checklist"></ul>
    </div>
      </div>
  </div>

  <!-- Plan Modal -->
  <div id="planBackdrop" class="modal-backdrop">
    <div class="modal">
      <div class="row" style="justify-content:space-between">
        <h3>üìò –ü–ª–∞–Ω / –û–±—è—Å–Ω–µ–Ω–∏—è</h3>
        <button class="secondary" onclick="closePlan()">‚úñ</button>
      </div>
      <div id="planContent" style="max-height:50vh; overflow:auto; line-height:1.4">
        <h4>–®–∞–º–ø–æ–∞–Ω–∏</h4>
        <p><strong>Nizoral (–∫–µ—Ç–æ–∫–æ–Ω–∞–∑–æ–ª 2%)</strong> ‚Äì –ø—Ä–æ—Ç–∏–≤–æ–≥—ä–±–∏—á–µ–Ω; –Ω–∞–º–∞–ª—è–≤–∞ Malassezia –∏ –≤—ä–∑–ø–∞–ª–µ–Ω–∏–µ—Ç–æ –Ω–∞ —Ñ–æ–ª–∏–∫—É–ª–∏—Ç–µ. –ü–æ–ª–∑–≤–∞–º–µ –≥–æ –ø—Ä–µ–∑ –¥–µ–Ω/—Ä–µ–¥—É–≤–∞–Ω–µ, –∑–∞ –¥–∞ –∏–∑–±–µ–≥–Ω–µ–º –∏–∑—Å—É—à–∞–≤–∞–Ω–µ –∏ –¥–∞ –ø–æ–¥–¥—ä—Ä–∂–∞–º–µ –ø—Ä–æ—Ç–∏–≤–æ–≥—ä–±–∏—á–µ–Ω –µ—Ñ–µ–∫—Ç.</p>
        <p><strong>Bioblas Zinc / —Ü–∏–Ω–∫–æ–≤ –ø–∏—Ä–∏—Ç–∏–æ–Ω</strong> ‚Äì –ø—Ä–æ—Ç–∏–≤–æ–≤—ä–∑–ø–∞–ª–∏—Ç–µ–ª–Ω–æ –∏ –∞–Ω—Ç–∏–º–∏–∫—Ä–æ–±–Ω–æ –∫—ä–º —Å–∫–∞–ª–ø–∞; —Ä–µ–¥—É–≤–∞–Ω–µ—Ç–æ —Å Nizoral –¥–∞–≤–∞ —à–∏—Ä–æ–∫ —Å–ø–µ–∫—Ç—ä—Ä –±–µ–∑ –¥–∞ –Ω–∞—Ç–æ–≤–∞—Ä–≤–∞ –∫–æ–∂–∞—Ç–∞ –≤—Å–µ–∫–∏ –¥–µ–Ω —Å –µ–¥–∏–Ω –∏ —Å—ä—â–∏ –∞–∫—Ç–∏–≤–µ–Ω –∞–≥–µ–Ω—Ç.</p>
        <h4>–ê–Ω—Ç–∏—Å–µ–ø—Ç–∏–∫–∞</h4>
        <p><strong>–•–ª–æ—Ä—Ö–µ–∫—Å–∏–¥–∏–Ω (Corsodyl)</strong> ‚Äì –ª–æ–∫–∞–ª–Ω–∞ –∞–Ω—Ç–∏—Å–µ–ø—Ç–∏–∫–∞ —Å–ª–µ–¥ –¥—É—à –∑–∞ –∑–æ–Ω–∞—Ç–∞ –Ω–∞ –±—Ä–∞–¥–∞—Ç–∞ –∏ —Å–∫–∞–ª–ø–∞; —Ü–µ–ª: –¥–∞ –Ω–∞–º–∞–ª–∏–º –±–∞–∫—Ç–µ—Ä–∏–∞–ª–Ω–æ—Ç–æ –Ω–∞—Ç–æ–≤–∞—Ä–≤–∞–Ω–µ —Å–ª–µ–¥ –ø–æ–¥—Å—Ç—Ä–∏–≥–≤–∞–Ω–µ/–º–∞—à–∏–Ω–∫–∞ –∏ –¥–∞ –æ–≥—Ä–∞–Ω–∏—á–∏–º —Ñ–æ–ª–∏–∫—É–ª–∏—Ç–∞.</p>
        <h4>–õ–æ–∫–∞–ª–µ–Ω –∞–Ω—Ç–∏–±–∏–æ—Ç–∏–∫</h4>
        <p><strong>–§—É—Ü–∏–¥–∏–Ω (—Ñ—É–∑–∏–¥–∏–µ–≤–∞ –∫–∏—Å–µ–ª–∏–Ω–∞)</strong> ‚Äì —Å–∞–º–æ –≤—ä—Ä—Ö—É –≥–æ–ª–µ–º–∏/–±–æ–ª–µ–∑–Ω–µ–Ω–∏ –ø—ä–ø–∫–∏ –≤–µ—á–µ—Ä –≤ —Ç—ä–Ω—ä–∫ —Å–ª–æ–π –∑–∞ 5‚Äì7 –¥–Ω–∏, –∑–∞ –¥–∞ –∏–∑–±–µ–≥–Ω–µ–º —Å–∏—Å—Ç–µ–º–Ω–∏ –∞–Ω—Ç–∏–±–∏–æ—Ç–∏—Ü–∏.</p>
        <h4>–î–æ–±–∞–≤–∫–∏</h4>
        <p><strong>–í–∏—Ç–∞–º–∏–Ω D3 + K2</strong> ‚Äì D3 –º–æ–¥—É–ª–∏—Ä–∞ –∏–º—É–Ω–∏—Ç–µ—Ç–∞ –∏ –≤—ä–∑–ø–∞–ª–µ–Ω–∏–µ—Ç–æ; K2 –Ω–∞—Å–æ—á–≤–∞ –∫–∞–ª—Ü–∏—è –∫—ä–º –∫–æ—Å—Ç–∏—Ç–µ –∏ –Ω–∞–º–∞–ª—è–≤–∞ —Ä–∏—Å–∫–∞ –æ—Ç –∫–∞–ª—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø—Ä–∏ –ø–æ-–≤–∏—Å–æ–∫–∏ –¥–æ–∑–∏ D3.</p>
        <p><strong>–û–º–µ–≥–∞‚Äë3</strong> ‚Äì –ø—Ä–æ—Ç–∏–≤–æ–≤—ä–∑–ø–∞–ª–∏—Ç–µ–ª–µ–Ω –µ—Ñ–µ–∫—Ç (EPA/DHA), –ø–æ–¥–∫—Ä–µ–ø—è –∫–æ–∂–Ω–∞—Ç–∞ –±–∞—Ä–∏–µ—Ä–∞ –∏ –¥–æ–ø—Ä–∏–Ω–∞—Å—è –∑–∞ –ø–æ-–¥–æ–±—ä—Ä –∫–æ–Ω—Ç—Ä–æ–ª –Ω–∞ —Å–µ–±—É–º–∞.</p>
        <p><strong>–í–∏—Ç–∞–º–∏–Ω C</strong> ‚Äì –∞–Ω—Ç–∏–æ–∫—Å–∏–¥–∞–Ω—Ç–Ω–∞ –∏ –∏–º—É–Ω–Ω–∞ –ø–æ–¥–∫—Ä–µ–ø–∞, –ø–æ–¥–ø–æ–º–∞–≥–∞ –≤—ä–∑—Å—Ç–∞–Ω–æ–≤—è–≤–∞–Ω–µ—Ç–æ –Ω–∞ —Ç—ä–∫–∞–Ω–∏—Ç–µ.</p>
        <p><strong>–ú–∞–≥–Ω–µ–∑–∏–π (–≥–ª–∏—Ü–∏–Ω–∞—Ç)</strong> ‚Äì —É—á–∞—Å—Ç–≤–∞ –≤ –∞–∫—Ç–∏–≤–∞—Ü–∏—è—Ç–∞ –Ω–∞ –≤–∏—Ç–∞–º–∏–Ω D; –≤–µ—á–µ—Ä –ø–æ–¥–æ–±—Ä—è–≤–∞ —Å—ä–Ω—è –∏ —Ä–µ–¥—É—Ü–∏—Ä–∞ —Å—Ç—Ä–µ—Å–∞.</p>
        <p><strong>–¶–∏–Ω–∫</strong> ‚Äì –≤–∞–∂–µ–Ω –∑–∞ –∏–º—É–Ω–∏—Ç–µ—Ç–∞ –∏ –∫–æ–∂–∞—Ç–∞; –¥–∞ –Ω–µ —Å–µ –∫–æ–º–±–∏–Ω–∏—Ä–∞ –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–æ —Å –±–æ–≥–∞—Ç–∏ –Ω–∞ –∫–∞–ª—Ü–∏–π —Ö—Ä–∞–Ω–∏ (–º–ª–µ—á–Ω–∏) –∑–∞ –ø–æ-–¥–æ–±—Ä–æ —É—Å–≤–æ—è–≤–∞–Ω–µ.</p>
        <h4>–•–∏–≥–∏–µ–Ω–∞ –∏ —Ç–µ–∫—Å—Ç–∏–ª</h4>
        <p>–†–µ–¥–æ–≤–Ω–∞ —Å–º—è–Ω–∞ –Ω–∞ –∫–∞–ª—ä—Ñ–∫–∞/–∫—ä—Ä–ø–∞ (–æ—Å–æ–±–µ–Ω–æ –≤ –Ω–µ–¥–µ–ª—è –≤–µ—á–µ—Ä) –∑–∞ –Ω–∞–º–∞–ª—è–≤–∞–Ω–µ –Ω–∞ –±–∞–∫—Ç–µ—Ä–∏–∞–ª–Ω–∏—è —Ç–æ–≤–∞—Ä –∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ—Ç–æ —Å–∞–º–æ–∑–∞—Ä–∞–∑—è–≤–∞–Ω–µ.</p>
      </div>
    </div>
  </div>

  <div class="footer">DP Design Tools ¬© 2025</div>

  <script>
    // ---- –°–µ–¥–º–∏—á–µ–Ω –±—Ä–æ—è—á ----
    if (!localStorage.getItem('startDate')) localStorage.setItem('startDate', new Date());
    const startDate = new Date(localStorage.getItem('startDate'));
    const todayDate = new Date();
    const diffDays = Math.floor((todayDate - startDate) / (1000 * 60 * 60 * 24));
    const weekNumber = Math.floor(diffDays / 7) + 1;
    document.getElementById('weekCounter').textContent = `–°–µ–¥–º–∏—Ü–∞ ${weekNumber} –æ—Ç 4`;
    if (weekNumber > 4) document.getElementById('weekCounter').textContent += " ‚Äî –ü—ä—Ä–≤–∏—è—Ç —Ü–∏–∫—ä–ª –∑–∞–≤—ä—Ä—à–∏! –í—Ä–µ–º–µ –µ –∑–∞ –Ω–æ–≤ —Ä–µ–∂–∏–º.";

    // ---- –ö–∞—Ä—Ç–∏ –Ω–∞ –¥–Ω–∏—Ç–µ ----
    const dayMap = { "–ø–æ–Ω–µ–¥–µ–ª–Ω–∏–∫": "monday", "–≤—Ç–æ—Ä–Ω–∏–∫": "tuesday", "—Å—Ä—è–¥–∞": "wednesday", "—á–µ—Ç–≤—ä—Ä—Ç—ä–∫": "thursday", "–ø–µ—Ç—ä–∫": "friday", "—Å—ä–±–æ—Ç–∞": "saturday", "–Ω–µ–¥–µ–ª—è": "sunday" };
    const bgByKey = { monday: "–ü–æ–Ω–µ–¥–µ–ª–Ω–∏–∫", tuesday: "–í—Ç–æ—Ä–Ω–∏–∫", wednesday: "–°—Ä—è–¥–∞", thursday: "–ß–µ—Ç–≤—ä—Ä—Ç—ä–∫", friday: "–ü–µ—Ç—ä–∫", saturday: "–°—ä–±–æ—Ç–∞", sunday: "–ù–µ–¥–µ–ª—è" };
    const order = ["monday","tuesday","wednesday","thursday","friday","saturday","sunday"];

    const todayBG = new Date().toLocaleDateString('bg-BG', { weekday: 'long' }).toLowerCase();
    const today = dayMap[todayBG];
    document.getElementById('dayTitle').textContent = todayBG.charAt(0).toUpperCase() + todayBG.slice(1);

    // ---- –ü–ª–∞–Ω –ø–æ —á–∞—Å–æ–≤–µ ----
    const dayPlan = {
      "monday": [
        { time: "07:00", task: "üöø –î—É—à —Å—É—Ç—Ä–∏–Ω + Nizoral" },
        { time: "07:15", task: "üíß Corsodyl (—Å–ª–µ–¥ –¥—É—à)" },
        { time: "08:00", task: "ü•§ –í–æ–¥–∞ —Å—É—Ç—Ä–∏–Ω" },
        { time: "08:30", task: "üíä –í–∏—Ç–∞–º–∏–Ω D3 (10 000 IU) + K2 (100 mcg) ‚Äì —Å –º–∞–∑–Ω–∏ —Ö—Ä–∞–Ω–∏" },
        { time: "08:35", task: "üêü –û–º–µ–≥–∞-3" },
        { time: "08:40", task: "üçä –í–∏—Ç–∞–º–∏–Ω C" },
        { time: "12:30", task: "ü•§ –í–æ–¥–∞ –æ–±–µ–¥" },
        { time: "18:30", task: "ü•§ –í–æ–¥–∞ –≤–µ—á–µ—Ä" },
        { time: "21:00", task: "üíä –ú–∞–≥–Ω–µ–∑–∏–µ–≤ –≥–ª–∏—Ü–∏–Ω–∞—Ç (200‚Äì400 mg)" },
        { time: "21:05", task: "üõ° –¶–∏–Ω–∫ (15‚Äì25 mg, –±–µ–∑ –º–ª–µ—á–Ω–∏ –¥–æ 1 —á.)" },
        { time: "21:30", task: "üåô –§—É—Ü–∏–¥–∏–Ω (—Å–∞–º–æ –≤—ä—Ä—Ö—É –≥–æ–ª–µ–º–∏ –ø—ä–ø–∫–∏)" },
        { time: "22:00", task: "üöø –î—É—à –≤–µ—á–µ—Ä + Bioblas Zinc" },
        { time: "22:30", task: "üò¥ –õ—è–≥–∞–º —Å–∏" }
      ],
      "tuesday": [
        { time: "07:00", task: "üöø –î—É—à —Å—É—Ç—Ä–∏–Ω + Bioblas Zinc" },
        { time: "07:15", task: "üíß Corsodyl (—Å–ª–µ–¥ –¥—É—à)" },
        { time: "08:00", task: "ü•§ –í–æ–¥–∞ —Å—É—Ç—Ä–∏–Ω" },
        { time: "08:30", task: "üíä –í–∏—Ç–∞–º–∏–Ω D3 (10 000 IU) + K2 (100 mcg) ‚Äì —Å –º–∞–∑–Ω–∏ —Ö—Ä–∞–Ω–∏" },
        { time: "08:35", task: "üêü –û–º–µ–≥–∞-3" },
        { time: "08:40", task: "üçä –í–∏—Ç–∞–º–∏–Ω C" },
        { time: "12:30", task: "ü•§ –í–æ–¥–∞ –æ–±–µ–¥" },
        { time: "18:30", task: "ü•§ –í–æ–¥–∞ –≤–µ—á–µ—Ä" },
        { time: "21:00", task: "üíä –ú–∞–≥–Ω–µ–∑–∏–µ–≤ –≥–ª–∏—Ü–∏–Ω–∞—Ç (200‚Äì400 mg)" },
        { time: "21:05", task: "üõ° –¶–∏–Ω–∫ (15‚Äì25 mg, –±–µ–∑ –º–ª–µ—á–Ω–∏ –¥–æ 1 —á.)" },
        { time: "21:30", task: "üåô –§—É—Ü–∏–¥–∏–Ω (—Å–∞–º–æ –≤—ä—Ä—Ö—É –≥–æ–ª–µ–º–∏ –ø—ä–ø–∫–∏)" },
        { time: "22:00", task: "üöø –î—É—à –≤–µ—á–µ—Ä + Bioblas Zinc" },
        { time: "22:30", task: "üò¥ –õ—è–≥–∞–º —Å–∏" }
      ],
      "wednesday": [
        { time: "06:10", task: "üöø –î—É—à —Å—É—Ç—Ä–∏–Ω + Nizoral" },
        { time: "06:25", task: "üíß Corsodyl (—Å–ª–µ–¥ –¥—É—à)" },
        { time: "07:00", task: "ü•§ –í–æ–¥–∞ —Å—É—Ç—Ä–∏–Ω" },
        { time: "08:30", task: "üíä –í–∏—Ç–∞–º–∏–Ω D3 (10 000 IU) + K2 (100 mcg) ‚Äì —Å –º–∞–∑–Ω–∏ —Ö—Ä–∞–Ω–∏" },
        { time: "08:35", task: "üêü –û–º–µ–≥–∞-3" },
        { time: "08:40", task: "üçä –í–∏—Ç–∞–º–∏–Ω C" },
        { time: "12:30", task: "ü•§ –í–æ–¥–∞ –æ–±–µ–¥" },
        { time: "18:30", task: "ü•§ –í–æ–¥–∞ –≤–µ—á–µ—Ä" },
        { time: "21:00", task: "üíä –ú–∞–≥–Ω–µ–∑–∏–µ–≤ –≥–ª–∏—Ü–∏–Ω–∞—Ç (200‚Äì400 mg)" },
        { time: "21:05", task: "üõ° –¶–∏–Ω–∫ (15‚Äì25 mg, –±–µ–∑ –º–ª–µ—á–Ω–∏ –¥–æ 1 —á.)" },
        { time: "21:30", task: "üåô –§—É—Ü–∏–¥–∏–Ω (—Å–∞–º–æ –≤—ä—Ä—Ö—É –≥–æ–ª–µ–º–∏ –ø—ä–ø–∫–∏)" },
        { time: "22:00", task: "üöø –î—É—à –≤–µ—á–µ—Ä + Bioblas Zinc" },
        { time: "22:30", task: "üò¥ –õ—è–≥–∞–º —Å–∏" }
      ],
      "thursday": [
        { time: "07:00", task: "üöø –î—É—à —Å—É—Ç—Ä–∏–Ω + Bioblas Zinc" },
        { time: "07:15", task: "üíß Corsodyl (—Å–ª–µ–¥ –¥—É—à)" },
        { time: "08:00", task: "ü•§ –í–æ–¥–∞ —Å—É—Ç—Ä–∏–Ω" },
        { time: "08:30", task: "üíä –í–∏—Ç–∞–º–∏–Ω D3 (10 000 IU) + K2 (100 mcg) ‚Äì —Å –º–∞–∑–Ω–∏ —Ö—Ä–∞–Ω–∏" },
        { time: "08:35", task: "üêü –û–º–µ–≥–∞-3" },
        { time: "08:40", task: "üçä –í–∏—Ç–∞–º–∏–Ω C" },
        { time: "12:30", task: "ü•§ –í–æ–¥–∞ –æ–±–µ–¥" },
        { time: "18:30", task: "ü•§ –í–æ–¥–∞ –≤–µ—á–µ—Ä" },
        { time: "21:00", task: "üíä –ú–∞–≥–Ω–µ–∑–∏–µ–≤ –≥–ª–∏—Ü–∏–Ω–∞—Ç (200‚Äì400 mg)" },
        { time: "21:05", task: "üõ° –¶–∏–Ω–∫ (15‚Äì25 mg, –±–µ–∑ –º–ª–µ—á–Ω–∏ –¥–æ 1 —á.)" },
        { time: "21:30", task: "üåô –§—É—Ü–∏–¥–∏–Ω (—Å–∞–º–æ –≤—ä—Ä—Ö—É –≥–æ–ª–µ–º–∏ –ø—ä–ø–∫–∏)" },
        { time: "22:00", task: "üöø –î—É—à –≤–µ—á–µ—Ä + Bioblas Zinc" },
        { time: "22:30", task: "üò¥ –õ—è–≥–∞–º —Å–∏" }
      ],
      "friday": [
        { time: "06:10", task: "üöø –î—É—à —Å—É—Ç—Ä–∏–Ω + Nizoral" },
        { time: "06:25", task: "üíß Corsodyl (—Å–ª–µ–¥ –¥—É—à)" },
        { time: "07:00", task: "ü•§ –í–æ–¥–∞ —Å—É—Ç—Ä–∏–Ω" },
        { time: "08:30", task: "üíä –í–∏—Ç–∞–º–∏–Ω D3 (10 000 IU) + K2 (100 mcg) ‚Äì —Å –º–∞–∑–Ω–∏ —Ö—Ä–∞–Ω–∏" },
        { time: "08:35", task: "üêü –û–º–µ–≥–∞-3" },
        { time: "08:40", task: "üçä –í–∏—Ç–∞–º–∏–Ω C" },
        { time: "12:30", task: "ü•§ –í–æ–¥–∞ –æ–±–µ–¥" },
        { time: "18:30", task: "ü•§ –í–æ–¥–∞ –≤–µ—á–µ—Ä" },
        { time: "21:00", task: "üíä –ú–∞–≥–Ω–µ–∑–∏–µ–≤ –≥–ª–∏—Ü–∏–Ω–∞—Ç (200‚Äì400 mg)" },
        { time: "21:05", task: "üõ° –¶–∏–Ω–∫ (15‚Äì25 mg, –±–µ–∑ –º–ª–µ—á–Ω–∏ –¥–æ 1 —á.)" },
        { time: "21:30", task: "üåô –§—É—Ü–∏–¥–∏–Ω (—Å–∞–º–æ –≤—ä—Ä—Ö—É –≥–æ–ª–µ–º–∏ –ø—ä–ø–∫–∏)" },
        { time: "22:00", task: "üöø –î—É—à –≤–µ—á–µ—Ä + Bioblas Zinc" },
        { time: "22:30", task: "üò¥ –õ—è–≥–∞–º —Å–∏" }
      ],
      "saturday": [
        { time: "08:30", task: "üöø –î—É—à —Å—É—Ç—Ä–∏–Ω + Bioblas Zinc" },
        { time: "08:45", task: "üíß Corsodyl (—Å–ª–µ–¥ –¥—É—à)" },
        { time: "09:00", task: "ü•§ –í–æ–¥–∞ —Å—É—Ç—Ä–∏–Ω" },
        { time: "09:30", task: "üíä –í–∏—Ç–∞–º–∏–Ω D3 (10 000 IU) + K2 (100 mcg) ‚Äì —Å –º–∞–∑–Ω–∏ —Ö—Ä–∞–Ω–∏" },
        { time: "09:35", task: "üêü –û–º–µ–≥–∞-3" },
        { time: "09:40", task: "üçä –í–∏—Ç–∞–º–∏–Ω C" },
        { time: "13:00", task: "ü•§ –í–æ–¥–∞ –æ–±–µ–¥" },
        { time: "19:00", task: "ü•§ –í–æ–¥–∞ –≤–µ—á–µ—Ä" },
        { time: "21:00", task: "üíä –ú–∞–≥–Ω–µ–∑–∏–µ–≤ –≥–ª–∏—Ü–∏–Ω–∞—Ç (200‚Äì400 mg)" },
        { time: "21:05", task: "üõ° –¶–∏–Ω–∫ (15‚Äì25 mg, –±–µ–∑ –º–ª–µ—á–Ω–∏ –¥–æ 1 —á.)" },
        { time: "21:30", task: "üåô –§—É—Ü–∏–¥–∏–Ω (—Å–∞–º–æ –≤—ä—Ä—Ö—É –≥–æ–ª–µ–º–∏ –ø—ä–ø–∫–∏)" },
        { time: "22:00", task: "üöø –î—É—à –≤–µ—á–µ—Ä + Bioblas Zinc" },
        { time: "23:00", task: "üò¥ –õ—è–≥–∞–º —Å–∏" }
      ],
      "sunday": [
        { time: "08:30", task: "üöø –î—É—à —Å—É—Ç—Ä–∏–Ω + Nizoral" },
        { time: "08:45", task: "üíß Corsodyl (—Å–ª–µ–¥ –¥—É—à)" },
        { time: "09:00", task: "ü•§ –í–æ–¥–∞ —Å—É—Ç—Ä–∏–Ω" },
        { time: "09:30", task: "üíä –í–∏—Ç–∞–º–∏–Ω D3 (10 000 IU) + K2 (100 mcg) ‚Äì —Å –º–∞–∑–Ω–∏ —Ö—Ä–∞–Ω–∏" },
        { time: "09:35", task: "üêü –û–º–µ–≥–∞-3" },
        { time: "09:40", task: "üçä –í–∏—Ç–∞–º–∏–Ω C" },
        { time: "13:00", task: "ü•§ –í–æ–¥–∞ –æ–±–µ–¥" },
        { time: "19:00", task: "ü•§ –í–æ–¥–∞ –≤–µ—á–µ—Ä" },
        { time: "20:30", task: "üõèÔ∏è –°–º—è–Ω–∞ –Ω–∞ –∫–∞–ª—ä—Ñ–∫–∞ –∏ –∫—ä—Ä–ø–∞" },
        { time: "21:00", task: "üíä –ú–∞–≥–Ω–µ–∑–∏–µ–≤ –≥–ª–∏—Ü–∏–Ω–∞—Ç (200‚Äì400 mg)" },
        { time: "21:05", task: "üõ° –¶–∏–Ω–∫ (15‚Äì25 mg, –±–µ–∑ –º–ª–µ—á–Ω–∏ –¥–æ 1 —á.)" },
        { time: "21:30", task: "üåô –§—É—Ü–∏–¥–∏–Ω (—Å–∞–º–æ –≤—ä—Ä—Ö—É –≥–æ–ª–µ–º–∏ –ø—ä–ø–∫–∏)" },
        { time: "22:00", task: "üöø –î—É—à –≤–µ—á–µ—Ä + Bioblas Zinc" },
        { time: "23:00", task: "üò¥ –õ—è–≥–∞–º —Å–∏" }
      ]
    };

    // ---- –ü–æ–ø—ä–ª–≤–∞–Ω–µ –Ω–∞ —Å–µ–¥–º–∏—á–Ω–∏—è –ø–ª–∞–Ω ----
    const weekPlanBody = document.getElementById('weekPlanBody');
    function toMinutes(hhmm){ const [h,m] = hhmm.split(':').map(Number); return h*60+m; }
    function renderWeek(){
      weekPlanBody.innerHTML = '';
      order.forEach(dayKey => {
        const rows = (dayPlan[dayKey] || []).slice().sort((a,b)=> toMinutes(a.time)-toMinutes(b.time));
        rows.forEach(entry => {
          const tr = document.createElement('tr');
          const tdDay = document.createElement('td'); tdDay.textContent = bgByKey[dayKey];
          const tdTime = document.createElement('td'); tdTime.textContent = entry.time;
          const tdTask = document.createElement('td'); tdTask.textContent = entry.task;
          tr.appendChild(tdDay); tr.appendChild(tdTime); tr.appendChild(tdTask);
          weekPlanBody.appendChild(tr);
        });
      });
    }

    // ---- –î–Ω–µ–≤–µ–Ω –ø–ª–∞–Ω + –ø—Ä–æ–≥—Ä–µ—Å ----
    const planBody = document.getElementById('planBody');
    const logs = JSON.parse(localStorage.getItem('dailyLogs') || '{}');
    const dateKey = todayDate.toISOString().split('T')[0];
    if (!logs[dateKey]) logs[dateKey] = {};

    function updateProgress() {
      const total = document.querySelectorAll('#planBody button').length;
      const done = Object.keys(logs[dateKey]).length;
      const percent = total ? Math.round((done / total) * 100) : 0;
      const bar = document.getElementById('progressBar');
      bar.style.width = percent + '%';
      bar.textContent = percent + '%';
    }

    function renderDay(){
      planBody.innerHTML = '';
      (dayPlan[today] || []).forEach(row => {
        const tr = document.createElement('tr');
        const tdTime = document.createElement('td'); tdTime.textContent = row.time;
        const tdTask = document.createElement('td'); tdTask.textContent = row.task;
        const tdStatus = document.createElement('td');
        const btn = document.createElement('button');
        btn.textContent = logs[dateKey][row.task] ? "‚úÖ " + logs[dateKey][row.task] : "–û—Ç–º–µ—Ç–Ω–∏";
        btn.onclick = () => {
          if (logs[dateKey][row.task]) { delete logs[dateKey][row.task]; btn.textContent = "–û—Ç–º–µ—Ç–Ω–∏"; }
          else { const now = new Date().toLocaleTimeString('bg-BG', { hour: '2-digit', minute: '2-digit' }); logs[dateKey][row.task] = now; btn.textContent = "‚úÖ " + now; }
          localStorage.setItem('dailyLogs', JSON.stringify(logs));
          updateProgress();
        };
        tdStatus.appendChild(btn);
        tr.appendChild(tdTime); tr.appendChild(tdTask); tr.appendChild(tdStatus);
        planBody.appendChild(tr);
      });
      updateProgress();
    }

    // ---- Toggle Week Section ----
    const weekSection = document.getElementById('weekSection');
    document.getElementById('toggleWeekBtn').addEventListener('click', () => {
      const show = weekSection.classList.toggle('hidden');
      if (!show) { // just opened
        renderWeek();
      }
    });

    // ---- Travel Modal ----
    const travelBackdrop = document.getElementById('travelBackdrop');
    const travelDays = document.getElementById('travelDays');
    const packingListEl = document.getElementById('packingList');
    document.getElementById('travelBtn').addEventListener('click', openTravel);
    document.getElementById('planBtn').addEventListener('click', openPlan);
    document.getElementById('resetBtn').addEventListener('click', resetProgress);

    function openTravel(){
      // build day checkboxes
      travelDays.innerHTML = '';
      order.forEach(k => {
        const id = `day-${k}`;
        const label = document.createElement('label');
        const cb = document.createElement('input'); cb.type='checkbox'; cb.id=id; cb.value=k;
        const span = document.createElement('span'); span.textContent = bgByKey[k];
        label.appendChild(cb); label.appendChild(span); travelDays.appendChild(label);
      });
      packingListEl.innerHTML = '';
      travelBackdrop.style.display = 'flex';
    }
    function closeTravel(){ travelBackdrop.style.display = 'none'; }

    function generatePacking(){
      const selected = Array.from(travelDays.querySelectorAll('input:checked')).map(cb=>cb.value);
      const items = new Set();
      if (selected.length) items.add('–õ–∏—á–Ω–∞ –∫—ä—Ä–ø–∞');
      selected.forEach(dayKey => {
        (dayPlan[dayKey]||[]).forEach(({task})=>{
          if (/Nizoral/i.test(task)) items.add('Nizoral 2% —à–∞–º–ø–æ–∞–Ω');
          if (/Bioblas/i.test(task) || /Zinc/i.test(task)) items.add('–®–∞–º–ø–æ–∞–Ω —Å —Ü–∏–Ω–∫–æ–≤ –ø–∏—Ä–∏—Ç–∏–æ–Ω');
          if (/Corsodyl/i.test(task) || /—Ö–ª–æ—Ä—Ö–µ–∫—Å–∏–¥–∏–Ω/i.test(task)) { items.add('–•–ª–æ—Ä—Ö–µ–∫—Å–∏–¥–∏–Ω —Ä–∞–∑—Ç–≤–æ—Ä'); items.add('–ú–∞—Ä–ª–∏/—Ç–∞–º–ø–æ–Ω–∏'); }
          if (/–§—É—Ü–∏–¥–∏–Ω/i.test(task)) items.add('–§—É—Ü–∏–¥–∏–Ω –∫—Ä–µ–º');
          if (/–∫–∞–ª—ä—Ñ–∫–∞/i.test(task)) items.add('–†–µ–∑–µ—Ä–≤–Ω–∞ –∫–∞–ª—ä—Ñ–∫–∞');
          if (/–∫—ä—Ä–ø–∞/i.test(task)) items.add('–î–æ–ø—ä–ª–Ω–∏—Ç–µ–ª–Ω–∞ –∫—ä—Ä–ø–∞ –∑–∞ –ª–∏—Ü–µ/–±—Ä–∞–¥–∞');
          if (/–í–æ–¥–∞/i.test(task)) items.add('–ë—É—Ç–∏–ª–∫–∞ –≤–æ–¥–∞ 0.5L');
          if (/–í–∏—Ç–∞–º–∏–Ω D3|K2/i.test(task)) { items.add('–í–∏—Ç–∞–º–∏–Ω D3 + K2'); items.add('–ö—É—Ç–∏–π–∫–∞ –∑–∞ —Ö–∞–ø—á–µ—Ç–∞'); }
          if (/–û–º–µ–≥–∞|Omega/i.test(task)) items.add('–û–º–µ–≥–∞‚Äë3 –∫–∞–ø—Å—É–ª–∏');
          if (/–í–∏—Ç–∞–º–∏–Ω C/i.test(task)) items.add('–í–∏—Ç–∞–º–∏–Ω C');
          if (/–ú–∞–≥–Ω–µ–∑–∏–µ–≤|Magnesium/i.test(task)) items.add('–ú–∞–≥–Ω–µ–∑–∏–π (–≥–ª–∏—Ü–∏–Ω–∞—Ç)');
          if (/–¶–∏–Ω–∫|Zinc/i.test(task)) items.add('–¶–∏–Ω–∫');
        });
      });
      packingListEl.innerHTML = '';
      if (!items.size) { packingListEl.innerHTML = '<li><em>–ù—è–º–∞ –∑–∞–¥–∞—á–∏ –≤ –∏–∑–±—Ä–∞–Ω–∏—Ç–µ –¥–Ω–∏.</em></li>'; return; }
      items.forEach(txt => {
        const li = document.createElement('li');
        const cb = document.createElement('input'); cb.type='checkbox';
        const span = document.createElement('span'); span.textContent = txt;
        li.appendChild(cb); li.appendChild(span); packingListEl.appendChild(li);
      });
    })=>{
          if (/Nizoral/i.test(task)) items.add('Nizoral 2% —à–∞–º–ø–æ–∞–Ω');
          if (/Bioblas/i.test(task) || /Zinc/i.test(task)) items.add('–®–∞–º–ø–æ–∞–Ω —Å —Ü–∏–Ω–∫–æ–≤ –ø–∏—Ä–∏—Ç–∏–æ–Ω');
          if (/Corsodyl/i.test(task) || /—Ö–ª–æ—Ä—Ö–µ–∫—Å–∏–¥–∏–Ω/i.test(task)) { items.add('–•–ª–æ—Ä—Ö–µ–∫—Å–∏–¥–∏–Ω —Ä–∞–∑—Ç–≤–æ—Ä'); items.add('–ú–∞—Ä–ª–∏/—Ç–∞–º–ø–æ–Ω–∏'); }
          if (/–§—É—Ü–∏–¥–∏–Ω/i.test(task)) items.add('–§—É—Ü–∏–¥–∏–Ω –∫—Ä–µ–º');
          if (/–∫–∞–ª—ä—Ñ–∫–∞/i.test(task)) items.add('–†–µ–∑–µ—Ä–≤–Ω–∞ –∫–∞–ª—ä—Ñ–∫–∞');
          if (/–∫—ä—Ä–ø–∞/i.test(task)) items.add('–î–æ–ø—ä–ª–Ω–∏—Ç–µ–ª–Ω–∞ –∫—ä—Ä–ø–∞ –∑–∞ –ª–∏—Ü–µ/–±—Ä–∞–¥–∞');
          if (/–í–æ–¥–∞/i.test(task)) items.add('–ë—É—Ç–∏–ª–∫–∞ –≤–æ–¥–∞ 0.5L');
        });
      });
      // Render checklist
      packingListEl.innerHTML = '';
      if (!items.size) { packingListEl.innerHTML = '<li><em>–ù—è–º–∞ –∑–∞–¥–∞—á–∏ –≤ –∏–∑–±—Ä–∞–Ω–∏—Ç–µ –¥–Ω–∏.</em></li>'; return; }
      items.forEach(txt => {
        const li = document.createElement('li');
        const cb = document.createElement('input'); cb.type='checkbox';
        const span = document.createElement('span'); span.textContent = txt;
        li.appendChild(cb); li.appendChild(span); packingListEl.appendChild(li);
      });
    }

    async function copyPacking(){
      const lines = Array.from(packingListEl.querySelectorAll('li span')).map(s=>`- [ ] ${s.textContent}`);
      try { await navigator.clipboard.writeText(lines.join('\n')); alert('–°–ø–∏—Å—ä–∫—ä—Ç –µ –∫–æ–ø–∏—Ä–∞–Ω.'); }
      catch(e){ alert('–ö–æ–ø–∏—Ä–∞–Ω–µ—Ç–æ –Ω–µ –±–µ—à–µ –ø–æ–∑–≤–æ–ª–µ–Ω–æ –æ—Ç –±—Ä–∞—É–∑—ä—Ä–∞.'); }
    }

    function showHistory() {
      const logs = JSON.parse(localStorage.getItem('dailyLogs') || '{}');
      let msg = "–ò—Å—Ç–æ—Ä–∏—è –ø–æ—Å–ª–µ–¥–Ω–∏ 7 –¥–Ω–∏:
";
      const keys = Object.keys(logs).slice(-7);
      keys.forEach(k => { msg += `
${k}: ${Object.keys(logs[k]).length} –∑–∞–¥–∞—á–∏ –∏–∑–ø—ä–ª–Ω–µ–Ω–∏`; });
      alert(msg);
    }

    // ---- –ü–ª–∞–Ω –º–æ–¥–∞–ª ----
    function openPlan(){ document.getElementById('planBackdrop').style.display = 'flex'; }
    function closePlan(){ document.getElementById('planBackdrop').style.display = 'none'; }

    // ---- –†–µ—Å–µ—Ç –ø—Ä–æ–≥—Ä–µ—Å ----
    function resetProgress(){
      const text = "–¢–æ–≤–∞ –¥–µ–π—Å—Ç–≤–∏–µ —â–µ —Ä–µ—Å—Ç–∞—Ä—Ç–∏—Ä–∞ —Ü–µ–ª–∏—è —Ü–∏–∫—ä–ª –∏ —â–µ –∑–∞–≥—É–±–∏—Ç–µ –ø—Ä–æ–≥—Ä–µ—Å–∞ –¥–æ –º–æ–º–µ–Ω—Ç–∞. –°–∏–≥—É—Ä–Ω–∏ –ª–∏ —Å—Ç–µ, —á–µ –∏—Å–∫–∞—Ç–µ –¥–∞ –≥–æ –Ω–∞–ø—Ä–∞–≤–∏—Ç–µ?

–í—ä–≤–µ–¥–µ—Ç–µ YES –∑–∞ –ø–æ—Ç–≤—ä—Ä–∂–¥–µ–Ω–∏–µ –∏–ª–∏ NO –∑–∞ –æ—Ç–∫–∞–∑.";
      const ans = prompt(text, "NO");
      if (!ans) return;
      const val = String(ans).trim().toLowerCase();
      if (val === 'yes') {
        // –∑–∞–Ω—É–ª—è–≤–∞–Ω–µ —Å–∞–º–æ –Ω–∞ –Ω–∞—à–∏—Ç–µ –∫–ª—é—á–æ–≤–µ
        localStorage.removeItem('dailyLogs');
        localStorage.setItem('startDate', new Date());
        alert('–ü—Ä–æ–≥—Ä–µ—Å—ä—Ç –µ –Ω—É–ª–∏—Ä–∞–Ω –∏ —Ü–∏–∫—ä–ª—ä—Ç –µ —Ä–µ—Å—Ç–∞—Ä—Ç–∏—Ä–∞–Ω.');
        location.reload();
      } else {
        alert('–û–ø–µ—Ä–∞—Ü–∏—è—Ç–∞ –µ –æ—Ç–∫–∞–∑–∞–Ω–∞.');
      }
    }');
      let msg = "–ò—Å—Ç–æ—Ä–∏—è –ø–æ—Å–ª–µ–¥–Ω–∏ 7 –¥–Ω–∏:\n";
      const keys = Object.keys(logs).slice(-7);
      keys.forEach(k => { msg += `\n${k}: ${Object.keys(logs[k]).length} –∑–∞–¥–∞—á–∏ –∏–∑–ø—ä–ª–Ω–µ–Ω–∏`; });
      alert(msg);
    }

    // ---- Initial render ----
    renderDay();
  </script>
</body>
</html>
